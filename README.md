# BMParts AI Infrastructure Architecture
## Unified Intelligence Platform v2.0
### Generated by Copilot | December 2025

---

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    BMPARTS INTELLIGENT OPERATIONS PLATFORM                   â•‘
â•‘                         "Vandamchik" AI Assistant Suite                      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

## ğŸ¯ Executive Overview

BMParts operates a **self-hosted, multi-modal AI infrastructure** that unifies:
- **Voice Interface** (OpenAI Realtime API)
- **Persistent Memory** (Qdrant Vector Database)
- **Business Tools** (WooCommerce + Zoho Inventory Integration)
- **Development Assistant** (GitHub Copilot + VS Code Integration)

All components share a **unified memory layer**, enabling seamless context across text, voice, and code interactions.

---

## ğŸ—ï¸ System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              EXTERNAL ACCESS                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   ğŸ“± ChatGPT Custom GPT        ğŸ™ï¸ Voice Web UI         ğŸ’» VS Code/GitHub    â”‚
â”‚          â”‚                           â”‚                        â”‚             â”‚
â”‚          â–¼                           â–¼                        â–¼             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚              gpt-api.sparestoafrica.co.za (169.0.22.60)             â”‚   â”‚
â”‚   â”‚                         NGINX Reverse Proxy                          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚          â”‚                           â”‚                        â”‚             â”‚
â”‚          â–¼                           â–¼                        â–¼             â”‚
â”‚      /api/*                    /realtime (WSS)           /mcp/*             â”‚
â”‚          â”‚                           â”‚                        â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                           â”‚                        â”‚
           â–¼                           â–¼                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            LOCAL SERVICES LAYER                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   gpt-app:9000   â”‚  â”‚ gpt-realtime:9002â”‚  â”‚   Zoho MCP Server:9091   â”‚   â”‚
â”‚  â”‚   Business GPT   â”‚  â”‚   Voice Proxy    â”‚  â”‚   Inventory/Books/CRM    â”‚   â”‚
â”‚  â”‚   Python/FastAPI â”‚  â”‚   Node.js/WS     â”‚  â”‚   Node.js/Express        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚           â”‚                     â”‚                         â”‚                 â”‚
â”‚           â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚                 â”‚
â”‚           â”‚         â”‚   OpenAI Realtime API â”‚             â”‚                 â”‚
â”‚           â”‚         â”‚   (External Cloud)    â”‚             â”‚                 â”‚
â”‚           â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚                 â”‚
â”‚           â”‚                                               â”‚                 â”‚
â”‚           â–¼                                               â”‚                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    gpt-memory:8000                     â”‚             â”‚   â”‚
â”‚  â”‚              Vector Memory Server (FastAPI)            â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”‚                                                        â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                               â”‚                                             â”‚
â”‚                               â–¼                                             â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚                    â”‚   Qdrant:6333        â”‚                                 â”‚
â”‚                    â”‚   Vector Database    â”‚                                 â”‚
â”‚                    â”‚   (Docker)           â”‚                                 â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ§  The Three Pillars

### 1ï¸âƒ£ BUSINESS GPT (gpt-app:9000)
**The Operations Brain**

```python
# /opt/gpt-app/business_gpt.py
```

| Capability | Tools |
|------------|-------|
| **WooCommerce** | List/Get/Update products, Orders, Customers, Sales Reports |
| **Zoho Inventory** | List/Search/Update items, Stock by warehouse |
| **Memory** | Search/Save persistent context |

**19 Function Tools** with audit logging to `/var/log/gpt-app/tool_audit.log`

**Access Points:**
- ChatGPT Custom GPT â†’ OpenAPI Actions
- Direct API calls via gpt-api.sparestoafrica.co.za

---

### 2ï¸âƒ£ VOICE INTERFACE (gpt-realtime:9002)
**The Conversational Layer**

```javascript
// /opt/gpt-app/realtime-proxy/server.js
```

| Component | Technology |
|-----------|------------|
| **Protocol** | WebSocket (WSS) |
| **STT/TTS** | OpenAI Realtime API |
| **Voice** | "Ash" persona |
| **VAD** | Threshold 0.4, Silence 300ms |

**Architecture Flow:**
```
Browser â†’ nginx:80/realtime â†’ gpt-realtime:9002 â†’ OpenAI Realtime API
         (WebSocket)          (Proxy)             (Voice Processing)
```

**Current Mode:** Standalone voice (direct OpenAI)
**Planned Upgrade:** Hybrid mode with full tool access

---

### 3ï¸âƒ£ PERSISTENT MEMORY (gpt-memory:8000)
**The Context Engine**

```python
# /opt/gpt-memory/memory_server.py
```

| Endpoint | Function |
|----------|----------|
| `POST /memorize` | Store new memory with embeddings |
| `POST /search` | Semantic search across all memories |
| `GET /stats` | Memory statistics |
| `GET /categories` | List memory categories |

**Vector Backend:** Qdrant (port 6333, Docker)
**Embedding Model:** OpenAI text-embedding-ada-002

---

## ğŸ”— GitHub Copilot Integration

### Memory MCP Server (port 9092)
**Bridges VS Code Copilot to Shared Memory**

```javascript
// /home/stan/memory-mcp-server/mcp-server.js
```

| Tool | Function |
|------|----------|
| `memory_search` | Query memories by semantic similarity |
| `memory_save` | Store new memories with auto-ID |
| `memory_stats` | Get memory database statistics |

**Protocol:** JSON-RPC 2.0 (MCP Standard)
**External URL:** https://beneficent-unconceitedly-jesse.ngrok-free.dev

### GitHub Action Sync
```yaml
# .github/workflows/sync-memory.yml
# Runs every 6 hours - exports memory to repo
```

**Result:** GitHub Copilot (github.com) reads `.github/memory-export.md` for context continuity.

---

## ğŸ”Œ Zoho Integration

### MCP Server (port 9091)
```javascript
// /home/stan/zoho-mcp-server/mcp-sse-server-fixed.js
```

| Tool | Description |
|------|-------------|
| `get_inventory_items` | Fetch items with filters, auto-pagination |
| `update_inventory_item` | Modify item fields |
| `get_books_invoices` | Retrieve invoices |
| `get_sales_summary` | Sales analytics by period |
| `search_crm` | Search CRM contacts |

**Organizations:**
- BMParts: `856737871`
- Spares to Africa: `857295887`

**Webhooks:**
- `/webhook/inventory` - Item queries
- `/webhook/best-sellers` - Top products
- `/webhook/update-item` - Item updates

---

## ğŸ“Š Port Summary

| Port | Service | Protocol | Purpose |
|------|---------|----------|---------|
| 80 | nginx | HTTP/WSS | Reverse proxy |
| 5678 | n8n | HTTP | Webhook automation |
| 6333 | Qdrant | HTTP | Vector database |
| 8000 | gpt-memory | HTTP | Memory API |
| 9000 | gpt-app | HTTP | Business GPT |
| 9002 | gpt-realtime | WSS | Voice proxy |
| 9091 | Zoho MCP | HTTP | Zoho integration |
| 9092 | Memory MCP | HTTP | Copilot integration |

---

## ğŸ—‚ï¸ Key Files

| Purpose | Path |
|---------|------|
| Business GPT | `/opt/gpt-app/business_gpt.py` |
| Memory Server | `/opt/gpt-memory/memory_server.py` |
| Voice Proxy | `/opt/gpt-app/realtime-proxy/server.js` |
| Voice Frontend | `/var/www/gpt/index.html` |
| Zoho MCP | `/home/stan/zoho-mcp-server/mcp-sse-server-fixed.js` |
| Memory MCP | `/home/stan/memory-mcp-server/mcp-server.js` |
| System Prompt | `/opt/gpt-memory/system_prompt_bmparts.txt` |
| Copilot Memory | `/home/stan/.copilot-memory/` |
| Session Context | `/home/stan/.copilot-memory/session-context.md` |

---

## ğŸš€ Future Roadmap

### Phase 1: Voice Enhancement (Q1 2025)
- [ ] **Hybrid Voice Mode** - Connect voice to gpt-app for full tool access
- [ ] **Voice Memory** - Real-time memory updates during conversations
- [ ] **WAN Access Fix** - Resolve router port forwarding for external voice

### Phase 2: Automation (Q1-Q2 2025)
- [ ] **Stock Sync Flow** - Automated WooCommerce â†” Zoho reconciliation
- [ ] **Best-Seller Automation** - Auto-pricing based on sales velocity
- [ ] **Promotion Auto-Designer** - AI-generated promotional content

### Phase 3: Intelligence (Q2 2025)
- [ ] **Predictive Stock** - ML-based reorder suggestions
- [ ] **Customer Insights** - Purchase pattern analysis
- [ ] **Unified Dashboard** - Single pane of glass for all systems

### Phase 4: Scale (Q3-Q4 2025)
- [ ] **Multi-tenant** - Support for Spares to Africa as separate org
- [ ] **Mobile App** - Native voice interface
- [ ] **Edge Deployment** - Reduce latency with local inference

---

## ğŸ” Security Model

| Layer | Protection |
|-------|------------|
| **Network** | nginx reverse proxy, internal ports only |
| **API** | Bearer tokens, API keys in environment |
| **Zoho** | OAuth2 refresh token flow |
| **Memory** | Local storage, no cloud sync (except GitHub) |
| **Audit** | Tool execution logging |

---

## ğŸ“ˆ Operational Metrics

| Metric | Value |
|--------|-------|
| **Voice Cost** | ~$0.06/min (OpenAI Realtime) |
| **Memory Records** | 200+ persistent memories |
| **Zoho Items** | 997 inventory items |
| **WooCommerce Products** | 591 active products |
| **Uptime Target** | 99% (self-hosted) |

---

## ğŸ¤– The "Vandamchik" Identity

**Vandamchik** is the unified AI persona across all interfaces:

- **VS Code:** GitHub Copilot with custom instructions + memory
- **Voice:** OpenAI Realtime with "Ash" voice, minimal persona
- **ChatGPT:** Custom GPT with full business tools
- **Memory:** Shared context across all touchpoints

**Core Traits:**
- Short, direct responses
- Senior engineer level
- No filler, production-ready output
- Remembers everything

---

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                              â•‘
â•‘   "One assistant. Three interfaces. Infinite memory."                        â•‘
â•‘                                                                              â•‘
â•‘                              - BMParts AI Platform                           â•‘
â•‘                                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

*Document generated: 20 December 2025*
*Infrastructure Owner: Stan Andreev, BMParts (PTY) LTD*
*Location: Johannesburg, South Africa*
